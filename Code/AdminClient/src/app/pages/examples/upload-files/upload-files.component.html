<div class="container mx-auto mt-4">
  <div class="row">
    <div class="col-12">
      <admin-breadcrumb></admin-breadcrumb>
      <h1 class="mb-3"> Upload Files Example</h1>
      <p class="text-muted mb-4">This form demonstrates various PrimeNG components organized into logical sections.</p>

      <form [formGroup]="formGroup" (ngSubmit)="onSubmit()">

        <!-- Multiple Upload Files -->
        <p-panel header="Multiple Upload Files" styleClass="mb-4">
          <p-fileupload name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php" (onUpload)="onUpload($event)" [multiple]="true" accept="image/*" maxFileSize="1000000" mode="advanced">
            <ng-template #empty>
              <div class="d-flex align-items-center justify-content-center flex-column">
                <i class="h1 pi pi-cloud-upload"></i>
                <p class="mt-3 mb-0">Drag and drop files to here to upload.</p>
              </div>
              </ng-template>
              <ng-template #content let-files let-uploadedFiles="uploadedFiles" let-removeFileCallback="removeFileCallback" let-removeUploadedFileCallback="removeUploadedFileCallback">
                <ng-template #file></ng-template>
                <!-- show the pending upload files -->
                <ng-container *ngIf="files?.length > 0">
                  <h6 class="mb-0 text-muted text-center">Pending Upload</h6>
                  <div class="p-fileupload-file-list ng-star-inserted">
                    <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of files; let i = index">
                      <p-image preview="true" class="p-fileupload-file-thumbnail ng-star-inserted" [src]="file.objectURL" [alt]="file.name" width="80" />
                      <div class="p-fileupload-file-info">
                        <div class="p-fileupload-file-name">{{ file.name }}</div>
                        <span class="p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                      </div>
                      <div class="p-fileupload-file-actions">
                        <p-button text rounded icon="pi pi-times" severity="danger"(onClick)="removeUploadedFileCallback(i)">
                        </p-button>
                      </div>
                    </div>
                  </div>
                </ng-container>
                <ng-container *ngIf="uploadedFiles?.length > 0">
                  <h6 class="mb-0 text-muted text-center">Uploaded Files</h6>
                  <div class="p-fileupload-file-list ng-star-inserted">
                    <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of uploadedFiles; let i = index">
                      <p-image preview="true" class="p-fileupload-file-thumbnail ng-star-inserted" [src]="file.objectURL" [alt]="file.name" width="80" />
                      <div class="p-fileupload-file-info">
                        <div class="p-fileupload-file-name">{{ file.name }}</div>
                        <span class="p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                      </div>
                      <div class="p-fileupload-file-actions">
                        <p-button text rounded icon="pi pi-times" severity="danger"(onClick)="removeUploadedFileCallback(i)">
                        </p-button>
                      </div>
                    </div>
                  </div>
                </ng-container>
              </ng-template>
          </p-fileupload>
        </p-panel>

        <!-- Single Upload Files -->
        <p-panel header="Single Upload Files" styleClass="mb-4">
          <p-fileupload name="demo[]" url="https://www.primefaces.org/cdn/api/upload.php" (onUpload)="onUpload($event)" [multiple]="false" accept="image/*" maxFileSize="1000000" mode="advanced">
            <ng-template #empty>
              <div class="d-flex align-items-center justify-content-center flex-column">
                <i class="h1 pi pi-cloud-upload"></i>
                <p class="mt-3 mb-0">Drag and drop files to here to upload.</p>
            </div>
            </ng-template>
            <ng-template #content let-files let-uploadedFiles="uploadedFiles" let-removeFileCallback="removeFileCallback" let-removeUploadedFileCallback="removeUploadedFileCallback">
              <!-- hide the original file list (by making it empty)-->
              <ng-template #file></ng-template>
              <!-- show the pending upload files -->
              <ng-container *ngIf="files?.length > 0">
                <h6 class="mb-0 text-muted text-center">Pending Upload</h6>
                <div class="p-fileupload-file-list ng-star-inserted">
                  <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of files; let i = index">
                    <p-image preview="true"  class="p-fileupload-file-thumbnail ng-star-inserted" [src]="file.objectURL" [alt]="file.name" width="80" />
                    <div class="p-fileupload-file-info">
                      <div class="p-fileupload-file-name">{{ file.name }}</div>
                      <span class="p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                    </div>
                    <div class="p-fileupload-file-actions">
                      <p-button text rounded icon="pi pi-times" severity="danger"(onClick)="removeUploadedFileCallback(i)">
                      </p-button>
                    </div>
                  </div>
                </div>
              </ng-container>
              <!-- show the uploaded files -->
              <ng-container *ngIf="uploadedFiles?.length > 0">
                <h6 class="mb-0 text-muted text-center">Uploaded Files</h6>
                <div class="p-fileupload-file-list ng-star-inserted">
                  <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of uploadedFiles; let i = index">
                    <p-image preview="true"  class="p-fileupload-file-thumbnail ng-star-inserted" [src]="file.objectURL" [alt]="file.name" width="80" />
                    <div class="p-fileupload-file-info">
                      <div class="p-fileupload-file-name">{{ file.name }}</div>
                      <span class="p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                    </div>
                    <div class="p-fileupload-file-actions">
                      <p-button text rounded icon="pi pi-times" severity="danger"(onClick)="removeUploadedFileCallback(i)">
                      </p-button>
                    </div>
                  </div>
                </div>
              </ng-container>
            </ng-template>
          </p-fileupload>
        </p-panel>

        <!-- Audio Upload Files -->
        <p-panel header="Audio Upload Files" styleClass="mb-4">
          <p-fileupload name="audio[]" url="https://www.primefaces.org/cdn/api/upload.php" (onUpload)="onAudioUpload($event)" [multiple]="true" accept="audio/*" maxFileSize="10000000" mode="advanced">
            <ng-template #empty>
              <div class="d-flex align-items-center justify-content-center flex-column">
                <i class="h1 pi pi-cloud-upload"></i>
                <p class="mt-3">Drag and drop audio files to here to upload.</p>
                <p class="text-muted small">Supported formats: MP3, WAV, OGG, etc.</p>
              </div>
            </ng-template>
            <ng-template #content let-files let-uploadedFiles="uploadedFiles" let-removeFileCallback="removeFileCallback" let-removeUploadedFileCallback="removeUploadedFileCallback">
              <ng-template #file></ng-template>
              <!-- show the pending upload files -->
              <ng-container *ngIf="files?.length > 0">
                <h6 class="mb-0 text-muted text-center">Pending Upload</h6>
                <div class="p-fileupload-file-list ng-star-inserted">
                  <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of files; let i = index">
                    <div class="p-fileupload-file-thumbnail audio-thumbnail align-self-start">
                      <i class="pi pi-cloud-upload" style="font-size: 2rem;"></i>
                    </div>
                    <div class="p-fileupload-file-info">
                      <div class="p-fileupload-file-name">
                        {{ file.name }} <span class="ms-3 p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                      </div>
                      <div class="audio-player mt-2">
                        <audio controls #audioElement [src]="getSafeUrl(file.objectURL)" preload="metadata" (play)="playAudio(audioElement)"></audio>
                      </div>
                    </div>
                    <div class="p-fileupload-file-actions">
                      <p-button text rounded icon="pi pi-times" severity="danger" (onClick)="removeFileCallback(i)">
                      </p-button>
                    </div>
                  </div>
                </div>
              </ng-container>
              <!-- show the uploaded files -->
              <ng-container *ngIf="audioFiles?.length > 0">
                <h6 class="mb-0 text-muted text-center">Uploaded Audio Files</h6>
                <div class="p-fileupload-file-list ng-star-inserted">
                  <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of audioFiles; let i = index">
                    <div class="p-fileupload-file-thumbnail audio-thumbnail align-self-start">
                      <i class="pi pi-check text-success" style="font-size: 2rem;"></i>
                    </div>
                    <div class="p-fileupload-file-info">
                      <div class="p-fileupload-file-name">
                        {{ file.name }} <span class="ms-3 p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                      </div>
                      <div class="audio-player mt-2">
                        <audio controls #audioElement [src]="file.safeUrl" preload="metadata" (play)="playAudio(audioElement)"></audio>
                      </div>
                    </div>
                    <div class="p-fileupload-file-actions">
                      <p-button text rounded icon="pi pi-times" severity="danger" (onClick)="removeAudioFile(i)">
                      </p-button>
                    </div>
                  </div>
                </div>
              </ng-container>
            </ng-template>
          </p-fileupload>
        </p-panel>

        <!-- Video Upload Files -->
        <p-panel header="Video Upload Files" styleClass="mb-4">
          <p-fileupload name="video[]" url="https://www.primefaces.org/cdn/api/upload.php" (onUpload)="onVideoUpload($event)" [multiple]="true" accept="video/*" maxFileSize="50000000" mode="advanced">
            <ng-template #empty>
              <div class="d-flex align-items-center justify-content-center flex-column">
                <i class="h1 pi pi-cloud-upload"></i>
                <p class="mt-3">Drag and drop video files to here to upload.</p>
                <p class="text-muted small">Supported formats: MP4, WebM, MOV, etc.</p>
              </div>
            </ng-template>
            <ng-template #content let-files let-uploadedFiles="uploadedFiles" let-removeFileCallback="removeFileCallback" let-removeUploadedFileCallback="removeUploadedFileCallback">
              <ng-template #file></ng-template>
              <!-- show the pending upload files -->
              <ng-container *ngIf="files?.length > 0">
                <h6 class="mb-0 text-muted text-center">Pending Upload</h6>
                <div class="p-fileupload-file-list ng-star-inserted">
                  <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of files; let i = index">
                    <div class="p-fileupload-file-thumbnail video-thumbnail align-self-start">
                      <i class="pi pi-cloud-upload" style="font-size: 2rem;"></i>
                    </div>
                    <div class="p-fileupload-file-info">
                      <div class="p-fileupload-file-name">
                        {{ file.name }} <span class="ms-3 p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                      </div>
                      <div class="video-player mt-2">
                        <video controls #videoElement [src]="getSafeUrl(file.objectURL)" preload="metadata" (play)="playVideo(videoElement)" width="100%"></video>
                      </div>
                    </div>
                    <div class="p-fileupload-file-actions">
                      <p-button text rounded icon="pi pi-times" severity="danger" (onClick)="removeFileCallback(i)">
                      </p-button>
                    </div>
                  </div>
                </div>
              </ng-container>
              <!-- show the uploaded files -->
              <ng-container *ngIf="videoFiles?.length > 0">
                <h6 class="mb-0 text-muted text-center">Uploaded Video Files</h6>
                <div class="p-fileupload-file-list ng-star-inserted">
                  <div class="p-fileupload-file ng-star-inserted" *ngFor="let file of videoFiles; let i = index">
                    <div class="p-fileupload-file-thumbnail video-thumbnail align-self-start">
                      <i class="pi pi-check text-success" style="font-size: 2rem;"></i>
                    </div>
                    <div class="p-fileupload-file-info">
                      <div class="p-fileupload-file-name">
                        {{ file.name }} <span class="ms-3 p-fileupload-file-size">{{ formatSize(file.size) }}</span>
                      </div>
                      <div class="video-player mt-2">
                        <video controls #videoElement [src]="file.safeUrl" preload="metadata" (play)="playVideo(videoElement)" width="100%"></video>
                      </div>
                    </div>
                    <div class="p-fileupload-file-actions">
                      <p-button text rounded icon="pi pi-times" severity="danger" (onClick)="removeVideoFile(i)">
                      </p-button>
                    </div>
                  </div>
                </div>
              </ng-container>
            </ng-template>
          </p-fileupload>
        </p-panel>
      </form>
    </div>
  </div>
</div>
